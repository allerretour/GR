<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="bookicontrans.png" />

    <title>Gestionnaire de raccourcis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js"></script>
    <link rel="stylesheet" href="styles.css" />
    <!-- Quill stylesheet and script -->
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet"
    />
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="emoji-list.js"></script>
  </head>

  <body>

    <div class="container">
      <div class="labels" style="position: relative;">
        


        <div
          class="title-container"
          style="display: flex; justify-content: center; margin: 10px auto; max-width: 800px;"
        >
          <div
            class="title-inner"
            style="display: inline-flex; align-items: center; gap: 14px;"
          >
            

            <h2
              id="appTitle"
              class="app-title"
              contenteditable="false"
              onblur="saveTitle()"
            >
              Gestionnaire de raccourcis
            </h2>

          </div>

        </div>
  

</div>

      <div
        style="display: flex; align-items: center; margin-top: 5px; gap: 10px;"
      >

<!-- Toggle Button -->
        <button
          id="searchToggleBtn"
          onclick="toggleSearchBar()"
          title="Afficher/masquer la recherche (F2)"
        >
          <i id="searchToggleIcon" class="fa-solid fa-magnifying-glass"></i>
        </button>


        <!-- Tag Filters -->

        <div
          id="tagFilters"
          class="tag-filter-container"
          style="cursor: move; flex-grow: 1;"
        ></div>
      </div>



      <!-- Search Bar (initially visible) -->
      <div
        id="searchContainer"
        style="display: none; position: relative; margin-top: 5px; justify-content: center;"
      >
        <div style="position: relative; width: 100%; max-width: 300px;">
          <input
            type="text"
            id="searchInput"
            placeholder="üîç Rechercher un raccourci..."
            oninput="handleSearchInput()"
            style="width: 100%; padding: 6px 28px 6px 10px; border: 1px solid #ccc; border-radius: 8px; font-size: 14px; box-sizing: border-box;"
          />
          <i
            id="clearSearchBtn"
            class="fas fa-times-circle"
            onclick="clearSearch()"
            title="Effacer la recherche"
            style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); font-size: 14px; color: #aaa; cursor: pointer; display: none; z-index: 2; pointer-events: auto;"
          ></i>
        </div>
      </div>
      <div id="shortcuts" class="shortcut-grid"></div>

  


   

<div id="dropZone" onclick="document.getElementById('importFile').click()" style="
  border: 2px dashed #fff;
  border-radius: 10px;
  padding: 20px;
  text-align: center;
  color: #ddd;
  font-size: 1.5rem;
  font-weight: 500;
  margin: 20px auto;
  
  cursor: pointer;
">
  ‚á© Glissez-d√©posez un fichier .lst ici pour charger une liste
</div>

<div style="text-align: left; display: flex; gap: 10px;margin-top: 15px;">
  <!-- Options button -->
  <button
    onclick="toggleButtonGroup()"
    id="toggleBtnGroup"
    class="left-button"
    title="Options (F4)"
    style="padding: 8px 12px; border: none; background: #f0f0f0; border-radius: 8px; cursor: pointer;"
  >
    <i class="fas fa-cog" style="color: #777;"></i>
  </button>

  <!-- Info button -->
  <button
    id="searchToggleBtn"
    onclick="showInfoModal()"
    title="Afficher/masquer l'aide (I)"
    style="padding: 8px 12px; border: none; background: #f0f0f0; border-radius: 8px; cursor: pointer;"
  >
    <i id="searchToggleIcon" class="fa-solid fa-circle-info" style="color: #777;;"></i>
  </button>
</div>

<div
        id="buttonGroupWrapper"
        class="button-group"
        style="margin-top: 15px;"
      >

           



        <button
          id="importBtn"
          title="Importer (L)"
          onclick="document.getElementById('importFile').click()"
        >
          <i class="fas fa-download"></i>
        </button>
        <button title="Ajouter (A)" onclick="openAddModal()">
          <i class="fas fa-plus"></i>
        </button>

<button
  id="mergeBtn"
  title="Fusionner une autre liste (.lst)"
  onclick="document.getElementById('mergeFile').click()"
>
  <i class="fas fa-layer-group"></i>
</button>

        <div class="filter-toggle">
          <input
            type="checkbox"
            id="tagFilterModeToggle"
            onchange="displayShortcuts()"
          />
          <label for="tagFilterModeToggle">
            Tags (Et/Ou): <strong><span id="filterModeLabel">OU</span></strong>
          </label>
        </div>

        
        <button
          id="sortButton"
          title="Trier (T)"
          onclick="toggleSorting();hideOptionsAndScrollTop();"
          style="background-color: lightgray; color: gray;"
        >
          <i
            id="sortIcon"
            class="fas fa-sort-alpha-down"
            style="color: gray;"
          ></i>
        </button>
        <button
          id="toggleTagsBtn"
          onclick="toggleTags();hideOptionsAndScrollTop();"
          title="Afficher/masquer les √©tiquettes (F4)"
        >
          <i class="fas fa-tags"></i>
        </button>

        <button title="Afficher/masquer mode compact (F9)" onclick="compactMode = !compactMode; displayShortcuts();hideOptionsAndScrollTop();">
          <i class="fas fa-compress-arrows-alt"></i>
        </button>

        <!-- Lock Button -->
            <button
              id="titleLockBtn"
              title="Verrouiller/d√©verrouiller le titre"
              
            >
              <i class="fa-solid fa-lock"></i>
            </button>

        
          <span style="font-size: 14px;">√âdition</span>
          <label class="switch" title="Mode √©dition">
            <input
              type="checkbox"
              id="editToggle"
              onchange="toggleEditMode()"
            />
            <span class="slider"></span>
          </label>

        <button title="Tout effacer (N)" onclick="clearShortcuts()">
          <i class="fas fa-trash"></i>
        </button>

        <button title="Exporter raccourcis visibles (V)" onclick="openExportFormatModal()">
          <i class="fa-solid fa-users-viewfinder"></i>
        </button>

<input
  type="file"
  id="mergeFile"
  accept=".lst"
  style="display: none"
  onchange="mergeShortcuts(event)"
/>
      
      <input
        type="file"
        id="importFile"
        style="display:none"
        onchange="importShortcuts(event)"
      />

        <button title="Exporter (S)" onclick="exportShortcuts()">
          <i class="fas fa-floppy-disk"></i>
        </button>

</div>

    </div>

    <div class="status-bar">
      <span
        id="exportStatusDot"
        class="status-dot"
        style="margin-left: 8px; font-size: 10px;"
        >üî¥</span
      >
      | <span id="lastExport">Dernier export : aucun</span> |
      <span id="sortStatus">Tri: Manuel</span> |
      <span id="editStatus">Mode √©dition: Non</span> |
      <span id="shortcutCount">Affich√©s: 0 / Total: 0</span>
    </div>
    <!-- Modal for editing -->
    <div
      id="editModal"
      style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;"
    >
      <div
        style="background:white; padding:20px; border-radius:8px; max-width:600px; width:90%;"
      >
        <h3>Modifier le raccourci</h3>
        <div style="margin-bottom: 12px;">
          <label for="editName" class="form-label">Nom :</label>
          <input
            type="text"
            id="editName"
            placeholder="Nom"
            style="width:90%;"
          />
        </div>
        <div style="margin-bottom: 12px;">
          <label for="editInfo" class="form-label"
            >Description compl√©mentaire :</label
          >
          <input
            type="text"
            id="editInfo"
            placeholder="Info compl√©mentaire (optionnel)"
            style="width:90%;"
          />
        </div>
        
<div style="display: flex; align-items: center; gap: 6px; margin-bottom: 12px;">
  <label for="editUrl" class="form-label" style="flex-shrink: 0;">
    URL : (Pour faire afficher le contenu de üí° inscrire ?)
  </label>
</div>
<div style="display: flex; align-items: center; gap: 2px;">
<button
    onclick="pasteFromClipboard('editUrl')"
    title="Coller depuis le presse-papiers"
    style="background: none; border: none; cursor: pointer; font-size: 1.4em; color: #555;"
  ><i class="fa-solid fa-paste"></i>
  </button>  

<button
    onclick="document.getElementById('editUrl').value = '?'"
    title="Ins√©rer ?"
    style="background: none; border: none; cursor: pointer; font-size: 1.4em; color: #555;"
  ><i class="fa-solid fa-circle-info"></i>
  </button>

<input
    type="text"
    id="editUrl"
    placeholder="URL ou ?"
    style="width: 78%;"
  />
  
</div>
        <div style="margin-bottom: 12px;">
          <label for="editTags" class="form-label">üè∑Ô∏è √âtiquettes :</label>
          <input
            type="text"
            id="editTagsInput"
            placeholder="Ajouter des √©tiquettes..."
            list="tagSuggestions"
            style="width:90%;"
            onkeydown="handleTagInput(event)"
          />
          <datalist id="tagSuggestions"></datalist>
          <div
            id="editTagsContainer"
            style="display:flex; flex-wrap:wrap; gap:6px; margin-top:6px;"
          ></div>
          <input type="hidden" id="editTags" />
        </div>
        <div style="margin-bottom: 12px;">
          <label for="editTooltip" class="form-label"
            >üí° Info du raccourci:</label
          >
          <div id="editTooltip" style="height: 150px; background: white;"></div>
        </div>
        <div style="text-align: right;">
          <button id="confirmBtn" type="button">‚úÖ Ajouter</button>
          <button type="button" onclick="closeEditModal()">‚ùå Annuler</button>
        </div>
      </div>
    </div>
    <div
      id="tooltipModal"
      onclick="closeTooltipModal()"
      style="
    display:none;
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.5);
    z-index:2000;
    align-items:center;
    justify-content:center;
"
    >
      <div
        onclick="event.stopPropagation()"
        style="
        background:white;
        padding:20px;
        border-radius:8px;
        max-width:600px;
        width:90%;
        max-height:80vh;
        display: flex;
        flex-direction: column;
    "
      >
        

        <div
          id="tooltipContent"
          style="
            white-space: pre-wrap;
            text-align: left;
            overflow: auto;
            flex-grow: 1;
            margin-top: 10px;
            margin-bottom: 10px;
        "
        ></div>

        <div style="text-align:right;">
          <button onclick="closeTooltipModal()">Fermer</button>
        </div>
      </div>
    </div>

    <div
      id="infoModal"
      onclick="closeInfoModal()"
      style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;"
    >
      <div onclick="event.stopPropagation()" class="info-modal-content">
        <button class="close-btn" onclick="closeInfoModal()" title="Fermer">
          <i class="fas fa-times"></i>
        </button>
        <h2>üéπ Raccourcis clavier et souris</h2>
        <div class="info-modal-grid">
          <div>
            <h3>‚å®Ô∏è Clavier</h3>
            <ul>
              <li><strong>I</strong> : Cette fen√™tre</li>
              <li>
                <strong>F2</strong> : Afficher / cacher la barre de recherche
              </li>
              <li><strong>F4</strong> : Afficher / cacher les options</li>
              <li><strong>F8</strong> : Afficher / cacher les √©tiquettes</li>
              <li><strong>F9</strong> : Afficher / cacher mode compact</li>
              <li><strong>T</strong> : Tri alphab√©tique / manuel</li>
              <li><strong>E</strong> : Activer / d√©sactiver √©dition</li>
              <li><strong>A</strong> : Ajouter une fiche</li>
              <li><strong>L</strong> : Charger une liste</li>
              <li><strong>S</strong> : Exporter la liste</li>
              <li><strong>V</strong> : Exporter raccourcis visibles</li>
              <li><strong>N</strong> : Nouvelle liste</li>
              <li><strong>M</strong> : Filtre ET / OU</li>
              <li><strong>CTRL+SHIFT+R</strong> : r√©initialiser la page</li>
            </ul>
          </div>
          <div>
            <h3>üñ±Ô∏è sur Raccourci</h3>
            <ul>
              <li><strong>Clic üëà</strong> : Ouvrir URL</li>
              <li><strong>Clic üëà garder 1 sec.</strong> : Copier URL</li>
              <li><strong>Clic üëâ</strong> : üí° Info</li>
              <h3>üñ±Ô∏è sur √âtiquette</h3>
              <li><strong>Clic üëà</strong> : Filtrer/d√©s√©lectionner</li>
              <li><strong>Clic üëâ</strong> : Filtre unique</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <button id="backToTopBtn" title="Haut de page">
      <i class="fas fa-arrow-up"></i>
    </button>


<!-- Export Format Modal -->
<div id="exportFormatModal" class="modal-overlay">
  <div class="modal-content export-modal">
    <h3>üì§ Exportation de raccourcis visibles</h3>
    <p>
      Choisissez le format de fichier √† exporter :<br>
      <span id="exportCount" style="font-weight: bold; color: #007bff;"></span>
    </p>

    <div class="export-buttons">
      <button class="export-btn txt" onclick="exportVisibleShortcuts('txt')">
        <i class="fas fa-file-lines"></i> Texte (.txt)
      </button>
      <button class="export-btn lst" onclick="exportVisibleShortcuts('lst')">
        <i class="fas fa-file-code"></i> JSON (.lst)
      </button>
      <button class="export-btn both" onclick="exportVisibleShortcuts('both')">
        <i class="fas fa-copy"></i> Les deux
      </button>
    </div>

    <div class="modal-footer">
      <button class="cancel-btn" onclick="closeExportFormatModal()">‚úñ Annuler</button>
    </div>
  </div>
</div>


    <script src="script.js" defer></script>
    <script src="shortcuts.js" defer></script>
  </body>
  <div id="copyToast">‚úÖ Lien copi√©!</div>
</html>
